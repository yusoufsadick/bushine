{%- comment -%}
  Valentine Bundles Slider - Dark SaaS Style (SAFE)
{%- endcomment -%}

{%- assign bundle_collection = collections[section.settings.collection] | default: collections.all -%}

<section class="valentine-bundles-slider section" id="bundles-slider-{{ section.id }}">
  <div class="page-width">
    <div class="section__header">
      <h2 class="section__title gradient-text">
        {{ section.settings.title | default: 'Valentine Gift Bundles' }}
      </h2>

      <p class="section__subtitle">
        {{ section.settings.subtitle | default: 'Save more when you bundle the perfect gifts together' }}
      </p>
    </div>

    <div class="carousel-container">
      <div class="carousel-track">

        {%- if bundle_collection and bundle_collection.products.size > 0 -%}
          {%- for product in bundle_collection.products limit: section.settings.products_to_show -%}
            <div class="carousel-slide">
              <div class="bundle-card-dark glass-card">

                <a href="{{ product.url }}" class="bundle-card-dark__link">

                  <div class="bundle-card-dark__image">
                    {%- if product.featured_image -%}
                      <img
                        src="{{ product.featured_image | image_url: width: 900 }}"
                        alt="{{ product.title | escape }}"
                        loading="lazy">
                    {%- else -%}
                      <img
                        src="https://images.unsplash.com/photo-1511988617509-a57c8a288659?w=900&q=80"
                        alt="{{ product.title | escape }}"
                        loading="lazy">
                    {%- endif -%}

                    {%- if product.compare_at_price > product.price -%}
                      <span class="bundle-badge">SALE</span>
                    {%- endif -%}
                  </div>

                  <div class="bundle-card-dark__content">
                    <h3 class="bundle-card-dark__title">
                      {{ product.title }}
                    </h3>

                    <p class="bundle-card-dark__description">
                      {{ product.description | strip_html | truncate: 120 | default: "Perfect Valentine's bundle for your loved one" }}
                    </p>

                    <div class="bundle-card-dark__price">
                      {%- if product.compare_at_price > product.price -%}
                        <span class="price--compare">
                          {{ product.compare_at_price | money }}
                        </span>
                      {%- endif -%}

                      <span class="price--current">
                        {{ product.price | money }}
                      </span>
                    </div>

                    <span class="btn-dark-primary">
                      View Bundle
                    </span>
                  </div>

                </a>
              </div>
            </div>
          {%- endfor -%}
        {%- else -%}
          {%- for i in (1..3) -%}
            <div class="carousel-slide">
              <div class="bundle-card-dark glass-card">
                <div class="bundle-card-dark__image">
                  <img
                    src="https://images.unsplash.com/photo-1511988617509-a57c8a288659?w=900&q=80"
                    alt="Valentine Bundle {{ i }}"
                    loading="lazy">
                  <span class="bundle-badge">HOT</span>
                </div>

                <div class="bundle-card-dark__content">
                  <h3 class="bundle-card-dark__title">Premium Valentine Bundle {{ i }}</h3>
                  <p class="bundle-card-dark__description">
                    Perfect gift bundle for your loved one this Valentine's Day
                  </p>
                  <div class="bundle-card-dark__price">
                    <span class="price--current">$99.00</span>
                  </div>
                  <span class="btn-dark-primary">View Bundle</span>
                </div>
              </div>
            </div>
          {%- endfor -%}
        {%- endif -%}

      </div>
    </div>
  </div>
</section>

<style>
.valentine-bundles-slider {
  background: #0e0e14;
  padding: 6rem 0;
}

.section__header {
  text-align: center;
  margin-bottom: 3rem;
}

.section__title {
  font-size: clamp(2rem, 4vw, 3rem);
  font-weight: 800;
  color: #fff;
}

.section__subtitle {
  color: rgba(255,255,255,0.75);
  margin-top: .5rem;
}

.carousel-track {
  display: flex;
  gap: 1.5rem;
  overflow-x: auto;
  scroll-snap-type: x mandatory;
  padding-bottom: 1rem;
}

.carousel-slide {
  flex: 0 0 85%;
  scroll-snap-align: start;
}

@media (min-width: 768px) {
  .carousel-slide { flex: 0 0 45%; }
}

@media (min-width: 1024px) {
  .carousel-slide { flex: 0 0 30%; }
}

.bundle-card-dark {
  background: rgba(20,20,32,0.9);
  border-radius: 20px;
  overflow: hidden;
  height: 100%;
  display: flex;
  flex-direction: column;
}

.bundle-card-dark__image {
  position: relative;
  padding-top: 70%;
  overflow: hidden;
}

.bundle-card-dark__image img {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  object-fit: cover;
  transition: transform .4s ease;
}

.bundle-card-dark:hover img {
  transform: scale(1.08);
}

.bundle-badge {
  position: absolute;
  top: 1rem;
  right: 1rem;
  background: #ff2d95;
  color: #fff;
  font-size: .75rem;
  padding: .35rem .7rem;
  border-radius: 999px;
  font-weight: 700;
}

.bundle-card-dark__content {
  padding: 1.5rem;
  display: flex;
  flex-direction: column;
  flex: 1;
}

.bundle-card-dark__title {
  font-size: 1.2rem;
  font-weight: 700;
  color: #fff;
  margin-bottom: .5rem;
}

.bundle-card-dark__description {
  color: rgba(255,255,255,.75);
  font-size: .9rem;
  flex: 1;
}

.bundle-card-dark__price {
  margin: 1rem 0;
}

.price--compare {
  text-decoration: line-through;
  color: rgba(255,255,255,.4);
  margin-right: .5rem;
}

.price--current {
  font-size: 1.5rem;
  font-weight: 800;
  color: #ff2d95;
}

.btn-dark-primary {
  display: block;
  text-align: center;
  background: linear-gradient(135deg,#ff2d95,#ff5fc0);
  color: #fff;
  padding: .9rem 1.2rem;
  border-radius: 999px;
  font-weight: 700;
}
</style>

{% schema %}
{
  "name": "Valentine Bundles Slider",
  "settings": [
    { "type": "text", "id": "title", "label": "Title", "default": "Valentine Gift Bundles" },
    { "type": "textarea", "id": "subtitle", "label": "Subtitle" },
    { "type": "collection", "id": "collection", "label": "Collection" },
    { "type": "range", "id": "products_to_show", "label": "Products to show", "min": 3, "max": 12, "step": 3, "default": 6 }
  ],
  "presets": [
    { "name": "Valentine Bundles Slider" }
  ]
}
{% endschema %}
