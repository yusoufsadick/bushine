{%- comment -%}
  Gift Bundles Section
{%- endcomment -%}

{%- assign bundle_collection = collections[section.settings.collection] | default: collections.all -%}

<section class="gift-bundles section" id="gift-bundles-{{ section.id }}">
  <div class="container">
    <div class="section__header">
      <h2 class="section__title">{{ section.settings.title | default: 'Valentine Gift Bundles' }}</h2>
      {%- if section.settings.subtitle != blank -%}
        <p class="section__subtitle">{{ section.settings.subtitle }}</p>
      {%- else -%}
        <p class="section__subtitle">Save more when you bundle the perfect gifts together</p>
      {%- endif -%}
    </div>

    <div class="gift-bundles__grid grid grid--3">
      {%- for product in bundle_collection.products limit: section.settings.products_to_show -%}
        <div class="gift-bundle card">
          <a href="{{ product.url }}" class="gift-bundle__link">
            <div class="gift-bundle__image">
              {%- if product.featured_image -%}
                <img src="{{ product.featured_image | image_url: width: 600 }}" alt="{{ product.title }}" loading="lazy">
              {%- endif -%}
              {%- if product.compare_at_price > product.price -%}
                <span class="gift-bundle__badge badge badge--valentine">
                  Save {{ product.compare_at_price | minus: product.price | times: 100 | divided_by: product.compare_at_price }}%
                </span>
              {%- endif -%}
            </div>
            <div class="gift-bundle__content card__content">
              <h3 class="gift-bundle__title">{{ product.title }}</h3>
              <p class="gift-bundle__price">
                {%- if product.compare_at_price > product.price -%}
                  <span class="price--compare">{{ product.compare_at_price | money }}</span>
                {%- endif -%}
                <span class="price--current">{{ product.price | money }}</span>
              </p>
              <a href="{{ product.url }}" class="btn btn--primary">View Bundle</a>
            </div>
          </a>
        </div>
      {%- endfor -%}
    </div>
  </div>
</section>

<style>
  .gift-bundles {
    background: linear-gradient(135deg, rgba(244, 209, 209, 0.1) 0%, rgba(245, 230, 211, 0.1) 100%);
  }

  .gift-bundle {
    position: relative;
  }

  .gift-bundle__link {
    display: block;
    text-decoration: none;
    color: inherit;
  }

  .gift-bundle__image {
    position: relative;
    width: 100%;
    padding-top: 75%;
    overflow: hidden;
  }

  .gift-bundle__image img {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .gift-bundle__badge {
    position: absolute;
    top: 1rem;
    right: 1rem;
    z-index: 1;
  }

  .gift-bundle__title {
    font-family: var(--font-heading, 'Playfair Display', serif);
    font-size: 1.5rem;
    margin-bottom: 1rem;
  }

  .gift-bundle__price {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-bottom: 1.5rem;
  }

  .price--compare {
    text-decoration: line-through;
    color: rgba(44, 44, 44, 0.5);
    font-size: 0.9375rem;
  }

  .price--current {
    font-size: 1.5rem;
    font-weight: 600;
    color: var(--color-rose, #D4A5A5);
  }
</style>

{% schema %}
{
  "name": "Gift Bundles",
  "settings": [
    {
      "type": "text",
      "id": "title",
      "label": "Title",
      "default": "Valentine Gift Bundles"
    },
    {
      "type": "textarea",
      "id": "subtitle",
      "label": "Subtitle"
    },
    {
      "type": "collection",
      "id": "collection",
      "label": "Collection"
    },
    {
      "type": "range",
      "id": "products_to_show",
      "label": "Products to show",
      "min": 3,
      "max": 12,
      "step": 3,
      "default": 6
    }
  ],
  "presets": [
    {
      "name": "Gift Bundles"
    }
  ]
}
{% endschema %}
